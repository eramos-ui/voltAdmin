"use strict";(()=>{var e={};e.id=7826,e.ids=[7826],e.modules={20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},92048:e=>{e.exports=require("fs")},36705:e=>{e.exports=import("formidable")},46555:e=>{e.exports=import("uuid")},56249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},84979:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{config:()=>u,default:()=>c,routeModule:()=>p});var o=t(71802),i=t(47153),n=t(56249),s=t(24158),l=e([s]);s=(l.then?(await l)():l)[0];let c=(0,n.l)(s,"default"),u=(0,n.l)(s,"config"),p=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/testUploadFirebase",pathname:"/api/testUploadFirebase",bundlePath:"",filename:""},userland:s});a()}catch(e){a(e)}})},40388:(e,r,t)=>{t.d(r,{n:()=>i});let a=require("firebase-admin");var o=t.n(a);o().apps.length||o().initializeApp({credential:o().credential.cert({projectId:process.env.FIREBASE_PROJECT_ID,privateKey:process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n"),clientEmail:process.env.FIREBASE_CLIENT_EMAIL}),storageBucket:process.env.FIREBASE_STORAGE_BUCKET});let i=o().storage().bucket()},44442:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.d(r,{V:()=>s});var o=t(46555),i=t(40388),n=e([o]);o=(n.then?(await n)():n)[0];let s=async({fileName:e,fileData:r,fileType:t,fileClass:a,userId:n,rowId:s=""})=>{let l=`projects/${n}/${a}/${s}/${Date.now()}_${e}`,c=Buffer.from(r,"base64"),u=i.n.file(l),p=(0,o.v4)();return await u.save(c,{metadata:{contentType:t,metadata:{firebaseStorageDownloadTokens:p},cacheControl:"public,max-age=31536000"},public:!0,resumable:!1}),console.log("\uD83D\uDD11 en uploadFileToFirebase token:",p),`https://firebasestorage.googleapis.com/v0/b/${i.n.name}/o/${encodeURIComponent(l)}?alt=media&token=${p}`};a()}catch(e){a(e)}})},24158:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{config:()=>u,default:()=>c});var o=t(36705),i=t(44442),n=t(92048),s=t.n(n),l=e([o,i]);[o,i]=l.then?(await l)():l;let u={api:{bodyParser:!1}};async function c(e,r){if("POST"!==e.method)return r.status(405).json({error:"M\xe9todo no permitido"});(0,o.default)({multiples:!1}).parse(e,async(e,t,a)=>{if(e)return console.error("❌ Error al procesar formulario:",e),r.status(500).json({error:"Error al procesar archivo"});let o=a.file,n=Array.isArray(o)?o[0]:o;if(!n||!n.filepath||!n.mimetype||!n.originalFilename)return r.status(400).json({error:"Archivo inv\xe1lido o incompleto"});try{let e=(await s().promises.readFile(n.filepath)).toString("base64"),t=await (0,i.V)({fileName:n.originalFilename,fileData:e,fileType:n.mimetype,fileClass:"test",userId:"demo-user",rowId:"test-row"});return r.status(200).json({success:!0,downloadURL:t})}catch(e){return console.error("❌ Error al subir archivo a Firebase:",e),r.status(500).json({error:"Error al subir archivo"})}})}a()}catch(e){a(e)}})},47153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},71802:(e,r,t)=>{e.exports=t(20145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=84979);module.exports=t})();
exports.id=5314,exports.ids=[5314],exports.modules={39379:(e,t,i)=>{"use strict";i.d(t,{Z:()=>m});var l=i(10326),a=i(17577),o=i(23703),r=i(34548),n=i(29497),s=i(43440);let d=async(e,t)=>{if(!e)return{success:!1,error:"Por favor, selecciona un archivo."};let i=new FormData;i.append("file",e);try{let e=await fetch(t,{method:"POST",body:i});if(e.ok){let t=await e.json();return{success:!0,data:t.data,excelColumns:t.excelColumns}}{let t=await e.json();return console.log("en uploadExcelFile res,error",e,t),{success:!1,error:t.message}}}catch(e){return console.error("Error al subir el archivo:",e),{success:!1,error:"Error al procesar el archivo."}}},c=["NumActividad","Actividad","Presupuesto","FechaInicio","FechaTermino"],p=(e,t)=>{if(!t.length)return"150px";let i=e.length;t.forEach(t=>{let l=t[e];if(null!=l){let e=l.toString().length;i=Math.max(i,e)}});let l=Math.min(Math.max(10*i,100),300);return`${l}px`},u=(e,t)=>{if(!e||0===e.length)return[];let i=new Set;return e.forEach(e=>Object.keys(e).forEach(e=>i.add(e))),c.forEach(e=>i.add(e)),t.map(t=>{let i=t.name,l=!i.includes("NumActividad")&&e.every(e=>!isNaN(Number(e[i]))&&""!==e[i]);return{label:i,key:i,visible:!0,captionPosition:"top",type:t.type||l?"number":"string",inputType:t.inputType||(l?"number":"text"),textAlign:"number"===t.type?"right":"left",width:p(i,e),editable:!0,row:1}})},m=()=>{let{values:e,setFieldValue:t}=(0,o.u6)(),[i,c]=(0,a.useState)(null),[p,m]=(0,a.useState)(!0),[x,b]=(0,a.useState)(""),[f,h]=(0,a.useState)(null),g=async i=>{if(!i||e.activities&&e.activities.length>1&&!window.confirm(`Al cargar el nuevo Excel se recargar\xe1 la grilla de actividades perdiendo el actual contenido. \xbfRecarga otro excel?`))return;let l=await d(i,"/api/uploadExcel");if(l.success){b("Archivo subido exitosamente.");let e=l.data;u(e,Array.isArray(l.excelColumns)?l.excelColumns.map(e=>"string"==typeof e?{name:e,inputType:"text",type:"string"}:e):[]).map(e=>({field:e.key,editable:"NumActividad"!==e.key&&"Duracion"!==e.key,headerName:e.label,inputType:e.inputType,captionPosition:e.captionPosition||"top",validationSchema:e.validationSchema||void 0,width:e.width,row:"Actividad"===e.key?1:"Presupuesto"!==e.key?2:3})),m(!1),t("activities",e),h(null)}else h(l.error?.toString()||"Error al cargar el archivo")};return(0,l.jsxs)("div",{className:"mb-4 ml-1 flex items-center space-x-4",children:[l.jsx(r.hh,{label:"Excel con las actividades",useStandaloneForm:!1,showUploadButton:!1,onUploadSuccess:e=>{c(e),m(!0),t("excelFile",e)},className:"100%"}),i&&(0,l.jsxs)("span",{className:"ml-0 mt-2 text-blue-600 font-medium truncate max-w-xs",children:["\uD83D\uDCC4 ",i.name]}),l.jsx(r.op,{buttonStyle:"primary",size:"small",htmlType:"button",label:"Cargar actividades",icon:l.jsx(n.G,{icon:s.icc,size:"lg",color:"white"}),onClick:()=>g(i),disabled:!i||!p,style:{marginTop:"10px"}}),f&&l.jsx(r.UN,{label:f,fontColor:"#EF4444"})]})}},81210:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var l=i(10326);i(17577);var a=i(41092),o=i(34548);let r=({isOpen:e,width:t="500px",height:i="1000px",children:r,title:n,onClose:s,position:d="center",htmlContent:c="",backgroundColorForm:p="#fff"})=>e?l.jsx("div",{style:{position:"fixed",top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"none",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"15px"},children:(0,l.jsxs)("div",{style:{position:"fixed",...(()=>{switch(d){case"top":return{top:"10%",left:"50%",transform:"translate(-50%, 0)"};case"bottom":return{bottom:"10%",left:"50%",transform:"translate(-50%, 0)"};case"left":return{top:"50%",left:"10%",transform:"translate(0, -50%)"};case"right":return{top:"50%",right:"10%",transform:"translate(0, -50%)"};default:return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}})(),backgroundColor:p,backdropFilter:"none",borderRadius:"8px",width:t,maxWidth:"90%",padding:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",border:"2px solid #007BFF",display:"flex",flexDirection:"column",alignItems:"stretch",height:i,maxHeight:"85vh",overflowY:"auto"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px",width:"100%"},children:[n&&l.jsx("h2",{style:{margin:0,fontSize:"1.5rem"},children:n}),l.jsx(o.op,{label:"âœ–",tooltipPosition:"left",tooltipContent:"Cerrar el formulario",onClick:s,style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#555"}})]}),c&&l.jsx("div",{dangerouslySetInnerHTML:{__html:a.Z.sanitize(c)}}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:r})]})}):null},3698:(e,t,i)=>{"use strict";i.d(t,{Z:()=>y});var l=i(10326),a=i(17577),o=i(23703),r=i(10123),n=i(81107),s=i(52910),d=i(36837),c=i(14903),p=i(29497),u=i(43440),m=i(34548),x=i(77626),b=i.n(x),f=i(46226);let h=({field:e,meta:t,label:i,name:r,options:n,value:s,onChange:d,placeholder:c="Seleccione una opci\xf3n",required:p=!1,width:u="100%"})=>{let{setFieldValue:m}=(0,o.u6)(),x=r?e?.value:s,[h,g]=(0,a.useState)(x||""),y=t=>{e?(console.log(`ðŸ“Œ Actualizando Formik: ${e.name} = ${t}`),m(e.name,t)):(g(t),d&&d(t))};return(0,l.jsxs)("div",{className:"jsx-691dba67b551d93 custom-select-icon",children:[(0,l.jsxs)("label",{className:"jsx-691dba67b551d93 select-label",children:[i," ",p&&"*"]}),l.jsx("div",{className:"jsx-691dba67b551d93 options-container",children:n.map(e=>(0,l.jsxs)("div",{onClick:()=>y(e.value),className:`jsx-691dba67b551d93 option ${s===e.value?"selected":""}`,children:[l.jsx(f.default,{src:e.image,alt:e.label,width:120,height:120,className:"option-image"}),l.jsx("span",{className:"jsx-691dba67b551d93 option-label",children:e.label})]},e.value))}),t?.touched&&t.error&&l.jsx("div",{className:"jsx-691dba67b551d93 error-message",children:t.error}),l.jsx(b(),{id:"691dba67b551d93",children:".custom-select-icon.jsx-691dba67b551d93{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.select-label.jsx-691dba67b551d93{font-size:16px;font-weight:bold;margin-bottom:10px}.options-container.jsx-691dba67b551d93{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:15px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.option.jsx-691dba67b551d93{cursor:pointer;border:2px solid transparent;padding:10px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:border.2s ease-in-out;-moz-transition:border.2s ease-in-out;-o-transition:border.2s ease-in-out;transition:border.2s ease-in-out}.option.jsx-691dba67b551d93 img{width:40px;height:40px}.option-label.jsx-691dba67b551d93{margin-top:5px;font-size:14px;text-align:center}.option.selected.jsx-691dba67b551d93{border:2px solid#0070f3;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}"})]})};i(71661),i(81711);let g=["text","number","email","password","url","tel","search","color","file"],y=({columns:e,initialValues:t,onSave:i,onCancel:x,rowIndex:b,handleFileUpload:f,setIsDirty:y})=>{(0,a.useEffect)(()=>{y(!1)},[y]);let w=r.Ry(e.filter(e=>e.editable&&e.validationSchema).reduce((e,t)=>(e[t.field]=t.validationSchema,e),{})),v=e.reduce((e,t)=>(e[t.row]||(e[t.row]=[]),e[t.row].push(t),e),{}),j=(t,i,l)=>{l(t,i);let a=e.find(e=>e.field===t);a?.dependencies&&a.dependencies.forEach(({field:e,valueMap:t})=>{void 0!==t[i]&&l(e,t[i])})};return l.jsx(o.J9,{initialValues:t,validationSchema:w,onSubmit:(e,{setSubmitting:t})=>{i(e),y(!1),t(!1)},children:({handleSubmit:e,handleChange:t,setFieldValue:i,values:a})=>(0,l.jsxs)("div",{className:"dynamic-form",children:[Object.entries(v).map(([e,o])=>l.jsx("div",{className:"dynamic-form-row",children:o.filter(e=>e.editable).map(e=>{let o=!!e.dependsOn&&(null==a[e.dependsOn.field]||a[e.dependsOn.field]!==e.dependsOn.value);return l.jsx("div",{className:"dynamic-form-field",children:"file"===e.inputType?l.jsx(c.R,{id:e.field,name:e.field,label:e.headerName,width:e.width,accept:".pdf, .jpg",putFilenameInMessage:!0,value:a[e.field],disabled:o,required:e.required,onUploadSuccess:t=>{console.log("\uD83D\uDD11 Archivo subido en DynamicForm-JSX:",t),t&&(i(e.field,t),f?.(t,b,e.field))}}):"date"===e.inputType?l.jsx(m.ld,{label:e.headerName,name:e.field,theme:"light",width:"80px",value:a[e.field],disabled:o}):"select"===e.inputType&&e.options?l.jsx(d.A,{id:e.field,name:e.field,label:e.headerName,options:e.options,value:a[e.field],multiple:e.multiple,onChange:i=>t({target:{name:e.field,value:i}}),captionPosition:e.captionPosition||"top",theme:"light",width:e.width,required:e.required}):"selectIcon"===e.inputType&&e.options?l.jsx(h,{name:e.field,label:"Selecciona la forma del techo",options:e.options,value:a[e.field],width:e.width,onChange:t=>{i(e.field,t),e.dependsOn&&i(e.dependsOn.field,t),j(e.field,t,i)},required:e.required}):l.jsx(n.t,{id:e.field,label:e.headerName,width:e.width,style:{width:"100%"},value:a[e.field],placeholder:`Ingrese ${e.headerName.toLowerCase()}`,onChange:t,type:e.inputType&&g.includes(e.inputType)?e.inputType:"text",captionPosition:e.captionPosition||"top",theme:"light",disabled:o,required:e.required})},e.field)})},e)),(0,l.jsxs)("div",{className:"dynamic-form-actions",children:[l.jsx(s.o,{buttonStyle:"secondary",size:"small",htmlType:"button",label:"Cancelar",tooltipPosition:"top",onClick:x,icon:l.jsx(p.G,{icon:u.xf2,size:"lg",color:"white"}),tooltipContent:"Para salir del formulario sin actualizar"}),l.jsx(s.o,{buttonStyle:"primary",size:"small",label:"Guardar",style:{marginRight:"100px"},tooltipPosition:"left",onClick:()=>e(),icon:l.jsx(p.G,{icon:u.EdJ,size:"lg",color:"white"}),tooltipContent:"Para actualizar la grilla"})]})]})})}},68117:(e,t,i)=>{"use strict";i.d(t,{f:()=>l});let l=(e,t)=>{let i;if(!e)return console.error("**currentId es inv\xe1lido:",typeof e),"1";let l=String(e).split("."),a=l.length-1,o=parseInt(l[a],10);do o+=1,l[a]=o.toString(),i=l.join(".");while(t.has(i));return i}},77505:(e,t,i)=>{"use strict";i.d(t,{z:()=>l});let l=e=>[...e].sort((e,t)=>{let i=e=>e.split(".").map(e=>parseInt(e,10)),l=i(String(e.NumActividad)),a=i(String(t.NumActividad));for(let e=0;e<Math.max(l.length,a.length);e++){let t=l[e]||0,i=a[e]||0;if(t!==i)return t-i}return 0})},71661:()=>{}};